!function(){var t=L.extend({},L.Map.prototype),o=L.extend({},L.Control.prototype);L.Map.include({_controlledBounds:null,getControlledBounds:function(){return this._controlledBounds||this._calculateControlledBounds(),this._controlledBounds},_calculateControlledBounds:function(){for(var t=this.getSize(),o={topleft:[L.point(0,0)],topright:[L.point(t.x,0)],bottomleft:[L.point(0,t.y)],bottomright:[L.point(t.x,t.y)]},e=0,i=0;i<this._controlCorners.topleft.children.length;i++){var n=this._controlCorners.topleft.children[i];if(n.offsetTop+n.offsetLeft+n.offsetWidth+n.offsetHeight>0){for(var r=n.offsetTop,f=n.offsetLeft,s=r+n.offsetHeight,h=f+n.offsetWidth,a=0;a<o.topleft.length;a++)o.topleft[a]&&o.topleft[a].x<h&&(o.topleft[a]=null);o.topleft.push(L.point(h,e)),o.topleft.push(L.point(0,s)),e=s}}e=0;for(var i=0;i<this._controlCorners.topright.children.length;i++){var n=this._controlCorners.topright.children[i];if(n.offsetTop+n.offsetLeft+n.offsetWidth+n.offsetHeight>0){for(var r=n.offsetTop,f=n.offsetLeft+this._controlCorners.topright.offsetLeft,s=r+n.offsetHeight,h=f+n.offsetWidth,a=0;a<o.topright.length;a++)o.topright[a]&&o.topright[a].x>f&&(o.topright[a]=null);o.topright.push(L.point(f,e)),o.topright.push(L.point(t.x,s)),e=s}}for(var u=t.y,i=this._controlCorners.bottomleft.children.length-1;i>=0;i--){var n=this._controlCorners.bottomleft.children[i];if(n.offsetTop+n.offsetLeft+n.offsetWidth+n.offsetHeight>0){for(var r=n.offsetTop+this._controlCorners.bottomleft.offsetTop,f=n.offsetLeft,s=r+n.offsetHeight,h=f+n.offsetWidth,a=0;a<o.bottomleft.length;a++)o.bottomleft[a]&&o.bottomleft[a].x<h&&(o.bottomleft[a]=null);o.bottomleft.push(L.point(h,u)),o.bottomleft.push(L.point(0,r)),u=r}}u=t.y;for(var i=this._controlCorners.bottomright.children.length-1;i>=0;i--){var n=this._controlCorners.bottomright.children[i];if(n.offsetTop+n.offsetLeft+n.offsetWidth+n.offsetHeight>0){for(var r=n.offsetTop+this._controlCorners.bottomright.offsetTop,f=n.offsetLeft+this._controlCorners.bottomright.offsetLeft,s=r+n.offsetHeight,h=f+n.offsetWidth,a=0;a<o.bottomright.length;a++)o.bottomright[a]&&o.bottomright[a].x>f&&(o.bottomright[a]=null);o.bottomright.push(L.point(f,u)),o.bottomright.push(L.point(t.x,r)),u=r}}o.topleft=o.topleft.filter(function(t){return!!t}),o.topright=o.topright.filter(function(t){return!!t}),o.bottomleft=o.bottomleft.filter(function(t){return!!t}),o.bottomright=o.bottomright.filter(function(t){return!!t});var g=-(1/0),d=null;for(i=0;i<o.topleft.length;i++){var p=o.topleft[i];for(a=0;a<o.topright.length;a++){var c=o.topright[a];for(k=0;k<o.bottomleft.length;k++){var m=o.bottomleft[k];for(l=0;l<o.bottomright.length;l++){var b=o.bottomright[l],_=Math.max(p.y,c.y),v=Math.min(m.y,b.y),C=Math.max(p.x,m.x),x=Math.min(c.x,b.x),y=(v-_)*(x-C);y>g&&(g=y,d=L.bounds([[C,_],[x,v]]))}}}}var B,T;T=L.bounds([0,0],this.getSize()).getCenter(),B=this._lastControlledBounds?this._lastControlledBounds.getCenter():T;var z=d.getCenter();return this._controlledOffset=L.point([T.x-z.x,T.y-z.y]),this._lastControlledBounds=d,this._controlledBounds=d},getOffset:function(){return this._controlledOffset?this._controlledOffset:L.point(0,0)},_offsetLatLng:function(t,o){return o=void 0===o?this.getZoom():o,this.unproject(this.project(t,o).add(this.getOffset()),o)},_deoffsetLatLng:function(t,o){return o=void 0===o?this.getZoom():o,this.unproject(this.project(t,o).subtract(this.getOffset()),o)},setView:function(o,e){return t.setView.call(this,this._offsetLatLng(o,e),e)},setZoomAround:function(t,o,e){var i=this.getZoomScale(o),n=this.getSize().divideBy(2).subtract(this.getOffset()),r=t instanceof L.Point?t:this.latLngToContainerPoint(t),f=r.subtract(n).multiplyBy(1-1/i),s=this.containerPointToLatLng(n.add(f));return this.setView(s,o,{zoom:e})},setZoom:function(t,o){return this._loaded?this.setView(this._deoffsetLatLng(this.getCenter()),t,{zoom:o}):(this._zoom=t,this)},getBoundsZoom:function(t,o,e){t=L.latLngBounds(t);var i,n=this.getMinZoom()-(o?1:0),r=this.getMaxZoom(),f=this._controlledBounds,s=f?L.point(f.max.x-f.min.x,f.max.y-f.min.y):this.getSize(),l=t.getNorthWest(),h=t.getSouthEast(),a=!0;e=L.point(e||[0,0]);do n++,i=this.project(h,n).subtract(this.project(l,n)).add(e).floor(),a=o?i.x<s.x||i.y<s.y:s.contains(i);while(a&&n<=r);return a&&o?null:o?n:n-1},invalidateSize:function(){if(!this._loaded)return this;var o=this.getOffset();t.invalidateSize.call(this),this._calculateControlledBounds(),this.panBy(this.getOffset().subtract(o))}}),L.Control.include({addTo:function(t){return o.addTo.call(this,t),t.invalidateSize({animate:!0}),this},removeFrom:function(t){if(this._map){var e=this._map;return o.removeFrom.call(this,t),e.invalidateSize({animate:!0}),this}return o.removeFrom.call(this,t)}})}();